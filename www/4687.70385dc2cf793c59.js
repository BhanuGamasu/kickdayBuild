"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4687],{4687:(N,v,c)=>{c.r(v),c.d(v,{CreateListingPageModule:()=>J});var m=c(6814),p=c(95),d=c(9004),h=c(209),x=c(5861),e=c(6242),T=c(4414),C=c(5565),Z=c(185),y=c(6593);function P(n,s){if(1&n){const o=e.EpF();e.TgZ(0,"ion-item",54),e.NdJ("click",function(){const a=e.CHM(o).$implicit,r=e.oxw();return e.KtG(r.onPredictionSelect(a))}),e._uU(1),e.qZA()}if(2&n){const o=s.$implicit;e.xp6(1),e.hij(" ",o.description," ")}}function w(n,s){if(1&n){const o=e.EpF();e.TgZ(0,"ion-datetime",55),e.NdJ("ngModelChange",function(i){e.CHM(o);const a=e.oxw();return e.KtG(a.orderEndDateTime=i)})("ionChange",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.onDateTimeChange("orderEndDateTime"))}),e.qZA()}if(2&n){const o=e.oxw();e.Q6J("ngModel",o.orderEndDateTime)("showDefaultButtons",!0)}}function I(n,s){if(1&n){const o=e.EpF();e.TgZ(0,"ion-datetime",55),e.NdJ("ngModelChange",function(i){e.CHM(o);const a=e.oxw();return e.KtG(a.orderDeliveredDateTime=i)})("ionChange",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.onDateTimeChange("orderDeliveredDateTime"))}),e.qZA()}if(2&n){const o=e.oxw();e.Q6J("ngModel",o.orderDeliveredDateTime)("showDefaultButtons",!0)}}function M(n,s){if(1&n){const o=e.EpF();e.TgZ(0,"ion-item",6),e.NdJ("click",function(){const a=e.CHM(o).$implicit,r=e.oxw(2);return e.KtG(r.selectItem(a))}),e.TgZ(1,"ion-label"),e._uU(2),e.qZA()()}if(2&n){const o=s.$implicit,t=e.oxw(2);e.ekj("selected-item",t.isSelected(o)),e.xp6(2),e.Oqu(o)}}function D(n,s){if(1&n&&(e.TgZ(0,"ion-list",56),e.YNc(1,M,3,3,"ion-item",57),e.qZA()),2&n){const o=e.oxw();e.xp6(1),e.Q6J("ngForOf",o.results)}}function b(n,s){1&n&&(e.TgZ(0,"div",58),e._uU(1,"No results found "),e.qZA())}function k(n,s){if(1&n){const o=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",59)(2,"ion-text"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-col",60)(5,"ion-text"),e._uU(6),e.qZA()(),e.TgZ(7,"ion-col",60)(8,"ion-text"),e._uU(9),e.qZA()(),e.TgZ(10,"ion-col",61)(11,"ion-icon",62),e.NdJ("click",function(){const a=e.CHM(o).$implicit,r=e.oxw();return e.KtG(r.removeItem(a))}),e.qZA()()()}if(2&n){const o=s.$implicit;e.xp6(3),e.Oqu(o.name),e.xp6(3),e.hij("$ ",o.price,""),e.xp6(3),e.Oqu(o.quantity)}}function A(n,s){if(1&n){const o=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",59)(2,"ion-text"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-col",60),e._UZ(5,"ion-icon",63),e.qZA(),e.TgZ(6,"ion-col",60)(7,"ion-text"),e._uU(8),e.qZA()(),e.TgZ(9,"ion-col",46),e.NdJ("click",function(){const a=e.CHM(o).$implicit,r=e.oxw();return e.KtG(r.removeDeliveryItem(a))}),e._UZ(10,"ion-icon",64),e.qZA()()}if(2&n){const o=s.$implicit;e.xp6(3),e.Oqu(o.type),e.xp6(5),e.hij("$ ",o.price,"")}}function L(n,s){if(1&n){const o=e.EpF();e.ynx(0),e.TgZ(1,"ion-icon",65),e.NdJ("click",function(){const a=e.CHM(o).index,r=e.oxw();return e.KtG(r.removeImage(a))}),e.qZA(),e._UZ(2,"img",66),e.BQk()}if(2&n){const o=s.$implicit,t=s.index;e.xp6(2),e.MGl("alt","Selected image ",t+1,""),e.Q6J("src",o.image,e.LSH)}}const q=n=>({border:"none",padding:"0px",display:n}),O=[{path:"",component:(()=>{var n;class s{constructor(t,i,a,r,l,_){this.router=t,this.navCtrl=i,this.adminService=a,this.loadingCtrl=r,this.authService=l,this.sanitizer=_,this._id="",this.label="",this.selectedItemsText="",this.selectedItems=[],this.showOrderEndDateTimePicker=!1,this.showOrderDeliveredDateTimePicker=!1,this.orderEndDateTime="",this.orderDeliveredDateTime="",this.mediaImages=[],this.addCategoryData=["Biryani","Sweets","Cova","Fried Rice","Pizza","Burger","Desserts","Pani Puri","Cool Drinks","Mandi"],this.results=[],this.newItemName="",this.newItemPrice="",this.newItemQuantity="",this.items=[],this.deliveryType="",this.deliveryPrice=0,this.deliveryItems=[],this.alertButtons=[{text:"Cancel",role:"cancel",handler:()=>{console.log("Alert canceled")}},{text:"OK",role:"confirm",handler:g=>{this.youTubeUrl=g.enteredText}}],this.alertInputs=[{name:"enteredText",placeholder:"Enter URL"}],this.isFreeDelivery=!1,this.autocompleteService=new google.maps.places.AutocompleteService}ngOnInit(){}ionViewWillEnter(){var t=this;this._id=this.router.url.split("/")[2],this._id&&this.adminService.getListingBasedOnId({_id:this._id}).subscribe(i=>{var a;i.success&&(this.bindingData=i.data,this.orderEndDateTime=this.bindingData.orderDeliveredOn,this.deliveryItems=this.bindingData.deliveryOptions,this.items=this.bindingData.listingOrders.map(r=>({name:r.name,price:r.price,quantity:r.quantity})),this.youTubeUrl=this.bindingData.youtubeUrl,this.orderDeliveredDateTime=this.bindingData.orderEndsOn,console.log(i),this.mediaImages=[],null===(a=this.bindingData.imageArray)||void 0===a||a.map(function(){var r=(0,x.Z)(function*(l){var _;let g=yield t.authService.getLogoImageById({fileId:l}),f=null==g||null===(_=g.data)||void 0===_?void 0:_.name,u="";g.success||(u=""),"svg+xml"==g.data.mimetype&&(u=yield t.sanitizer.bypassSecurityTrustResourceUrl(`data:image/svg+xml;base64,${g.data.data}`)),u=`data:image/jpg;base64,${g.data.data}`,t.mediaImages.push({image:u,imageName:f,imageId:l})});return function(l){return r.apply(this,arguments)}}()))},i=>{console.log(i)}),this.search="",this.selectedPrediction=""}removeCategoryItem(t){this.selectedItems=this.selectedItems.filter(i=>i!==t)}handleInput(t){const i=t.target.value.toLowerCase();this.results=""===i.trim()?[]:this.addCategoryData.filter(a=>a.toLowerCase().indexOf(i)>-1)}selectItem(t){this.newItemName=t,this.results=[]}isSelected(t){return this.selectedItems.includes(t)}addItem(){this.newItemName&&this.newItemPrice&&this.newItemQuantity&&(this.items.push({name:this.newItemName,price:this.newItemPrice,quantity:this.newItemQuantity}),this.newItemName="",this.newItemPrice="",this.newItemQuantity="")}removeItem(t){this.items=this.items.filter(i=>i!==t)}addDeliveryItem(){this.deliveryType&&(this.deliveryPrice||0==this.deliveryPrice)&&(this.deliveryItems.push({type:this.deliveryType,price:this.deliveryPrice}),this.deliveryPrice=0)}removeDeliveryItem(t){this.deliveryItems=this.deliveryItems.filter(i=>i!==t)}addListing(){let t={address:this.selectedPrediction.formatted_address,lat:this.selectedPrediction.lat,lng:this.selectedPrediction.lng,label:this.label,category:this.selectedItems[0],orderEndsOn:new Date(this.orderDeliveredDateTime),orderDeliveredOn:new Date(this.orderEndDateTime),orders:this.items,deliveryOptions:this.deliveryItems,youtubeUrl:this.youTubeUrl,image:this.mediaImages};this._id&&(t._id=this._id),this.adminService.addEditListing(t).subscribe(i=>{i.success&&this.router.navigate(["/listings"])},i=>{console.log(i)})}goToBack(){this.navCtrl.back()}openDateTimePicker(t){"orderEndDateTime"===t?this.showOrderEndDateTimePicker=!0:"orderDeliveredDateTime"===t&&(this.showOrderDeliveredDateTimePicker=!0)}onDateTimeChange(t){"orderEndDateTime"===t?this.showOrderEndDateTimePicker=!1:"orderDeliveredDateTime"===t&&(this.showOrderDeliveredDateTimePicker=!1)}onSearchInput(){var t=this;return(0,x.Z)(function*(){var i;(null===(i=t.search)||void 0===i?void 0:i.length)>0?(yield t.loadingCtrl.create(),t.autocompleteService.getPlacePredictions({input:t.search},(r,l)=>{t.predictions=l===google.maps.places.PlacesServiceStatus.OK?r:[]})):t.predictions=[]})()}onPredictionSelect(t){this.search=t.description,new google.maps.places.PlacesService(document.createElement("div")).getDetails({placeId:t.place_id},(a,r)=>{r===google.maps.places.PlacesServiceStatus.OK&&(this.selectedPrediction=a,this.selectedPrediction.lat=a.geometry.location.lat(),this.selectedPrediction.lng=a.geometry.location.lng())}),this.predictions=[]}toggleFreeDelivery(){this.deliveryPrice=0,this.isFreeDelivery=!this.isFreeDelivery}addMediaImages(t){const a=t.target.files;a&&a.length>0&&this.addMultipleMediaImages(a)}addMultipleMediaImages(t){for(let i=0;i<t.length;i++){const a=t[i],r=new FileReader;r.onload=l=>{this.mediaImages.push({image:l.target.result,imageName:a.name})},r.readAsDataURL(a)}}removeImage(t){this.mediaImages.splice(t,1)}}return(n=s).\u0275fac=function(t){return new(t||n)(e.Y36(h.F0),e.Y36(T.SH),e.Y36(C.l),e.Y36(T.HT),e.Y36(Z.u),e.Y36(y.H7))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-listing"]],decls:118,vars:34,consts:[[3,"fullscreen"],[2,"margin","15px"],[1,"kd_center_align",2,"margin-top","10px"],[1,"kd_flex"],["name","newspaper-outline",1,"icon_style"],[2,"font-weight","bold","font-size","18px"],[3,"click"],[1,"kd_flex","kd_end_align"],[2,"font-weight","bold","font-size","12px","padding-right","10px"],["name","close-circle-outline",1,"icon_style","kd_no_padding"],[2,"position","relative"],[1,"search_item"],[2,"display","flex","justify-content","end"],["name","location-outline",2,"height","20px","width","20px"],["placeholder","Enter Your location","search-icon","false",2,"width","91%","height","100%","--box-shadow","0","padding","0px",3,"ngModel","value","ngModelChange","keypress"],[2,"padding","0px !important","position","absolute","z-index","1000","width","100%","box-shadow","0 2px 4px rgba(0, 0, 0, 0.5)","border-radius","8px"],["style","margin-right: 45px; padding: 10px",3,"click",4,"ngFor","ngForOf"],["aria-label","Custom textarea","placeholder","Give a catchy title(150 words)",1,"custom",3,"ngModel","value","ngModelChange"],[1,"calander_div",3,"click"],[1,"calander_div_text"],[1,"kd_col_center_align"],["name","calendar-number-outline",1,"kd_svg_size"],[1,"date_text"],[3,"ngModel","showDefaultButtons","ngModelChange","ionChange",4,"ngIf"],["size","5",2,"margin","15px 0px 0px 0px"],[2,"font-size","18px","font-weight","bold"],["lines","none",1,"search_item"],["placeholder","Add Item","search-icon","false",3,"debounce","ngModel","ngModelChange","ionInput"],["class","search-results",4,"ngIf"],["style","margin-top: 15px;",4,"ngIf"],["size","2.75",2,"margin","15px 0px 0px 0px"],["placeholder","$0",1,"input_selection",3,"ngModel","ngModelChange"],["placeholder","Eg:2",1,"input_selection",3,"ngModel","ngModelChange"],["size","1.5",1,"kd_flex","kd_flex_row_center","margin_top"],["name","add-circle-outline",1,"kd_svg_size",3,"click"],[4,"ngFor","ngForOf"],["size","5"],[2,"border","solid 1px black","border-radius","14px","padding-left","10px"],["label","Delivery type","aria-label","Fruit",2,"min-height","48px",3,"ngModel","ngModelChange"],["value","Pickup Available"],["value","Neighbourhood 5KM"],["value","Town/City 20KM"],["value","PAN India above 20KM"],["size","2.75"],[2,"font-size","10px","margin","0px",3,"click"],["placeholder","$ 0",1,"input_selection",2,"margin-top","0px",3,"disabled","ngModel","ngModelChange"],["size","1.5",1,"kd_flex","kd_flex_row_center",3,"click"],["name","add-circle-outline",1,"kd_svg_size"],[1,"add_img_div","ion-activatable","ripple-parent",3,"click"],["type","file","accept","image/*","multiple","",2,"display","none",3,"change"],["fileInput",""],["id","present-alert"],["trigger","present-alert","header","Please enter YouTube URL","cssClass","custom-alert",3,"buttons","inputs"],[1,"selected-images",2,"max-height","350px","overflow-y","auto","display","flex","flex-wrap","wrap","gap","10px","margin-bottom","20px",3,"ngStyle"],[2,"margin-right","45px","padding","10px",3,"click"],[3,"ngModel","showDefaultButtons","ngModelChange","ionChange"],[1,"search-results"],[3,"selected-item","click",4,"ngFor","ngForOf"],[2,"margin-top","15px"],["size","5",1,"kd_flex","kd_flex_row_center",2,"justify-content","start"],["size","2.75",1,"kd_flex","kd_flex_row_center"],["size","1.5",1,"kd_flex","kd_flex_row_center"],["name","trash-outline",1,"icon_size_30",3,"click"],["name","mail-outline",1,"icon_size_30"],["name","trash-outline",1,"icon_size_30"],["name","close",2,"position","relative","left","90%","height","25px","width","25px",3,"click"],[2,"flex","0 0 calc(30% - 10px)","max-height","30%",3,"src","alt"]],template:function(t,i){if(1&t){const a=e.EpF();e.TgZ(0,"ion-content",0)(1,"div",1)(2,"ion-row",2)(3,"ion-col")(4,"div",3),e._UZ(5,"ion-icon",4),e.TgZ(6,"ion-text",5),e._uU(7,"Create Listing"),e.qZA()()(),e.TgZ(8,"ion-col",6),e.NdJ("click",function(){return i.goToBack()}),e.TgZ(9,"div",7)(10,"ion-text",8),e._uU(11,"Cancel Listing"),e.qZA(),e._UZ(12,"ion-icon",9),e.qZA()()(),e.TgZ(13,"ion-row")(14,"ion-col")(15,"div",10)(16,"ion-item",11)(17,"ion-label",12),e._UZ(18,"ion-icon",13),e.qZA(),e.TgZ(19,"ion-searchbar",14),e.NdJ("ngModelChange",function(l){return i.search=l})("keypress",function(){return i.onSearchInput()}),e.qZA()(),e.TgZ(20,"ion-list",15),e.YNc(21,P,2,1,"ion-item",16),e.qZA()()()(),e.TgZ(22,"ion-row")(23,"ion-col")(24,"ion-textarea",17),e.NdJ("ngModelChange",function(l){return i.label=l}),e.qZA()()(),e.TgZ(25,"ion-row")(26,"ion-col")(27,"div",18),e.NdJ("click",function(){return i.openDateTimePicker("orderEndDateTime")}),e.TgZ(28,"ion-row")(29,"ion-col")(30,"ion-text",19),e._uU(31,"Order Ends with Date & Time ?"),e.qZA()()(),e.TgZ(32,"ion-row")(33,"ion-col",20),e._UZ(34,"ion-icon",21),e.TgZ(35,"ion-text",22),e._uU(36),e.ALo(37,"date"),e.qZA()()()(),e.YNc(38,w,1,2,"ion-datetime",23),e.qZA()(),e.TgZ(39,"ion-row")(40,"ion-col")(41,"div",18),e.NdJ("click",function(){return i.openDateTimePicker("orderDeliveredDateTime")}),e.TgZ(42,"ion-row")(43,"ion-col")(44,"ion-text",19),e._uU(45,"Order Delivered on ?"),e.qZA()()(),e.TgZ(46,"ion-row")(47,"ion-col",20),e._UZ(48,"ion-icon",21),e.TgZ(49,"ion-text",22),e._uU(50),e.ALo(51,"date"),e.qZA()()()(),e.YNc(52,I,1,2,"ion-datetime",23),e.qZA()(),e.TgZ(53,"ion-row")(54,"ion-col",24)(55,"ion-text",25),e._uU(56,"Item"),e.qZA(),e._UZ(57,"br"),e.TgZ(58,"div",26)(59,"ion-searchbar",27),e.NdJ("ngModelChange",function(l){return i.newItemName=l})("ionInput",function(l){return i.handleInput(l)}),e.qZA()(),e.YNc(60,D,2,1,"ion-list",28)(61,b,2,0,"div",29),e.qZA(),e.TgZ(62,"ion-col",30)(63,"ion-text",25),e._uU(64,"Price"),e.qZA(),e._UZ(65,"br"),e.TgZ(66,"ion-input",31),e.NdJ("ngModelChange",function(l){return i.newItemPrice=l}),e.qZA()(),e.TgZ(67,"ion-col",30)(68,"ion-text",25),e._uU(69,"Quantity"),e.qZA(),e._UZ(70,"br"),e.TgZ(71,"ion-input",32),e.NdJ("ngModelChange",function(l){return i.newItemQuantity=l}),e.qZA()(),e.TgZ(72,"ion-col",33)(73,"ion-icon",34),e.NdJ("click",function(){return i.addItem()}),e.qZA()()(),e.YNc(74,k,12,3,"ion-row",35),e.TgZ(75,"ion-row")(76,"ion-col")(77,"ion-text",25),e._uU(78,"Delivery type"),e.qZA()()(),e.TgZ(79,"ion-row")(80,"ion-col",36)(81,"ion-item",37)(82,"ion-select",38),e.NdJ("ngModelChange",function(l){return i.deliveryType=l}),e.TgZ(83,"ion-select-option",39),e._uU(84,"Pickup Available"),e.qZA(),e.TgZ(85,"ion-select-option",40),e._uU(86,"Neighbourhood 5KM"),e.qZA(),e.TgZ(87,"ion-select-option",41),e._uU(88,"Town/City 20KM"),e.qZA(),e.TgZ(89,"ion-select-option",42),e._uU(90,"PAN India above 20KM"),e.qZA()()()(),e.TgZ(91,"ion-col",43)(92,"ion-button",44),e.NdJ("click",function(){return i.toggleFreeDelivery()}),e._uU(93),e.qZA()(),e.TgZ(94,"ion-col",43)(95,"ion-input",45),e.NdJ("ngModelChange",function(l){return i.deliveryPrice=l}),e.qZA()(),e.TgZ(96,"ion-col",46),e.NdJ("click",function(){return i.addDeliveryItem()}),e._UZ(97,"ion-icon",47),e.qZA()(),e.YNc(98,A,11,2,"ion-row",35),e.TgZ(99,"ion-row")(100,"ion-col")(101,"div",48),e.NdJ("click",function(){e.CHM(a);const l=e.MAs(103);return e.KtG(l.click())}),e.TgZ(102,"input",49,50),e.NdJ("change",function(l){return i.addMediaImages(l)}),e.qZA(),e.TgZ(104,"ion-button"),e._uU(105,"Add Images"),e.qZA()()(),e.TgZ(106,"ion-col")(107,"ion-button",51),e._uU(108,"Add YouTube URL"),e.qZA()(),e._UZ(109,"ion-alert",52),e.qZA(),e.TgZ(110,"ion-row")(111,"ion-col")(112,"div",53),e.YNc(113,L,3,2,"ng-container",35),e.qZA()()(),e.TgZ(114,"ion-row")(115,"ion-col")(116,"ion-button",6),e.NdJ("click",function(){return i.addListing()}),e._uU(117,"ADD"),e.qZA()()()()()}2&t&&(e.Q6J("fullscreen",!0),e.xp6(19),e.Q6J("ngModel",i.search)("value",null==i.bindingData?null:i.bindingData.address),e.xp6(2),e.Q6J("ngForOf",i.predictions),e.xp6(3),e.Q6J("ngModel",i.label)("value",null==i.bindingData?null:i.bindingData.label),e.xp6(12),e.Oqu(e.xi3(37,26,i.orderEndDateTime,"d MMMM EEE h:mm a")),e.xp6(2),e.Q6J("ngIf",i.showOrderEndDateTimePicker),e.xp6(12),e.Oqu(e.xi3(51,29,i.orderDeliveredDateTime,"d MMMM EEE h:mm a")),e.xp6(2),e.Q6J("ngIf",i.showOrderDeliveredDateTimePicker),e.xp6(7),e.Q6J("debounce",100)("ngModel",i.newItemName),e.xp6(1),e.Q6J("ngIf",i.results.length>0),e.xp6(1),e.Q6J("ngIf",0===i.results.length&&i.selectedItemsText.length>0),e.xp6(5),e.Q6J("ngModel",i.newItemPrice),e.xp6(5),e.Q6J("ngModel",i.newItemQuantity),e.xp6(3),e.Q6J("ngForOf",i.items),e.xp6(8),e.Q6J("ngModel",i.deliveryType),e.xp6(11),e.Oqu(i.isFreeDelivery?"Delivery Fee":"Free Delivery"),e.xp6(2),e.Q6J("disabled",i.isFreeDelivery)("ngModel",i.deliveryPrice),e.xp6(3),e.Q6J("ngForOf",i.deliveryItems),e.xp6(11),e.Q6J("buttons",i.alertButtons)("inputs",i.alertInputs),e.xp6(3),e.Q6J("ngStyle",e.VKq(32,q,0===i.mediaImages.length?"none":"flex")),e.xp6(1),e.Q6J("ngForOf",i.mediaImages))},dependencies:[m.sg,m.O5,m.PC,p.JJ,p.On,d.Ge,d.YG,d.wI,d.W2,d.x4,d.gu,d.pK,d.Ie,d.Q$,d.q_,d.Nd,d.VI,d.t9,d.n0,d.yW,d.g2,d.QI,d.j9,m.uU],styles:[".selected-fruit[_ngcontent-%COMP%]{display:inline-flex;align-items:center;margin-right:15px;padding:8px;background-color:#e0e0e0;border-radius:4px;font-weight:700;margin-top:8px}.calander_div[_ngcontent-%COMP%]{border:solid 1px black;border-radius:14px;margin:15px 5px 0;padding:0 5px}.calander_div_text[_ngcontent-%COMP%]{font-size:12px;font-weight:700}.input_selection[_ngcontent-%COMP%]{border:solid 1px black;border-radius:14px;min-height:48px;box-shadow:none;--padding-start: 10px;margin-top:8px}.margin_top[_ngcontent-%COMP%]{margin-top:30px}.icon_size_30[_ngcontent-%COMP%]{height:30px;width:30px}ion-datetime[_ngcontent-%COMP%]{max-width:450px!important}.date_text[_ngcontent-%COMP%]{padding-left:10px;font-weight:700}ion-button[_ngcontent-%COMP%]{margin-right:0!important}"]}),s})()}];let U=(()=>{var n;class s{}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.Bz.forChild(O),h.Bz]}),s})(),J=(()=>{var n;class s{}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[m.ez,p.u5,d.Pc,U]}),s})()}}]);